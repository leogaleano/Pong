<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Hello!</title>
</head>

<body>
  <div id="root" style="text-align: center;">
    <div fw-if="isPageLogIn">
      <form fw-on:submit="submitLogIn">
        <h1>Log in</h1>

        <input type="text" name="username" fw-attr:value="username" fw-on:change="changeUsername"
          placeholder="Username or email" />
        <input type="password" name="password" fw-attr:value="password" fw-on:change="changePassword"
          placeholder="Password" />

        <input type="submit" value="log in" />

        <p fw-if="isFormInvalid">
          Validation error: <span fw-content="validationMessage"></span>
        </p>
      </form>
    </div>
    <div fw-if="isPageMain">
      <h1>Demo app</h1>
      <p>
        Hello, <span fw-content="username"></span>: this is the main page of a
        demo app.
      </p>
    </div>
  </div>

  <script>
    window.createApp = ({ rootElementId, initialState, handlers }) => {
      // ... ðŸ“

      //se crea la funcion del framkework if que muestra u oculta elementos, a la que se le pasa como parametros el root, el initialState y los handlers
      IfUpdater = (root, initialState, handlers) => {
        FwIfElements = Object.values(document.querySelectorAll('[fw-if]'))
        FwIfElements.map(e => {
          element = e.getAttribute("fw-if")
          e.style.display = (initialState[element]) ? "block" : "none"
        });
      }
      //se crea la funcion  del framework content que manejarÃ¡ el contenido de los elementos, a la que se le pasa como parametros el root, el initialState y los handlers
      ContentUpdater = (root, initialState, handlers) => {
        FwContentElements = Object.values(document.querySelectorAll("[fw-content]"))
        FwContentElements.map(e => {
          element = e.getAttribute("fw-content")
          e.innerHTML = initialState[element]
        });
      }

      // Se crea la funcion updater la cual llamarÃ¡ a las funciones IfUpdater y ContentUpdater, esta funcion serÃ¡ llamada por el create app para actualizar el contenido
      Updater = (root, initialState, handlers) => {
        IfUpdater(root, initialState, handlers);
        ContentUpdater(root, initialState, handlers);
      }

      Updater(rootElementId, initialState, handlers);

      const submit = document.getElementsByTagName('input')[2];
      submit.onclick = () => {

      }
    }


  </script>

  <script>
    window.createApp({
      rootElementId: "root",
      initialState: {
        isPageLogIn: true,
        isPageMain: false,
        username: "",
        password: "",
        isFormInvalid: false,
        validationMessage: "",
      },
      handlers: {
        changeUsername: (currentState, event) => {
          const username = event.target.value;
          return {
            ...currentState,
            isFormInvalid: false,
            username,
          };
        },
        changePassword: (currentState, event) => {
          const password = event.target.value;
          return {
            ...currentState,
            isFormInvalid: false,
            password,
          };
        },
        submitLogIn: (currentState, event) => {
          event.preventDefault();

          if (currentState.username === "") {
            return {
              ...currentState,
              isFormInvalid: true,
              validationMessage: "You must provide a username", // cuando clickas log in sin poner username
            };
          }

          if (currentState.password.length < 8) {
            return {
              ...currentState,
              isFormInvalid: true,
              validationMessage:
                "The password must contain at least 8 characters", // cuando clickas log in poniendo username
              // y no password
            };
          }

          return {
            ...currentState,
            isFormInvalid: false,
            isPageLogIn: false,
            isPageMain: true,
          };
        },
      },
    });
  </script>
</body>

</html>